"use strict";!function s(o,r,c){function l(n,e){if(!r[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(m)return m(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var a=r[n]={exports:{}};o[n][0].call(a.exports,function(e){return l(o[n][1][e]||e)},a,a.exports,s,o,r,c)}return r[n].exports}for(var m="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(e,n,t){var r=i(e("./views/LinkView")),c=i(e("./views/SearchView")),l=i(e("./views/SearchHeaderView"));function i(e){return e&&e.__esModule?e:{default:e}}var a=Backbone.Router.extend({routes:{"":"index","/":"index","all/hot":"index","all/man":"man","zone/:subject*path":"zone",search:"search","discovery/:category":"discovery",recommend:"recommend","topic/:topicId":"topic"},initialize:function(){},index:function(){(0,r.default)({page:"index",subject:"hot",type:"latest"})},zone:function(e,n){(0,r.default)({page:"zone",isSyncPage:"pic"!=e&&"video"!=e,subject:e,type:"hottest"})},man:function(){(0,r.default)({page:"man",isSyncPage:!0,type:"latest"})},search:function(e){var n=window.CT.getParam("searchType"),t=window.CT.getParam("words"),i=window.CT.getParam("time"),a=window.CT.getParam("linkType"),s=window.CT.getParam("subjectId"),o={page:"search",isSyncPage:!1,words:t,time:i||"",searchType:n,linkType:a||"",subjectId:s||"",pageNumber:1};(0,l.default)(o),3==n?(0,c.default)(o):(0,r.default)(o)},discovery:function(e){(0,r.default)({page:"discovery",isSyncPage:!0,category:e})},recommend:function(){(0,r.default)({page:"recommend",isSyncPage:!0})},topic:function(n){window.CT.getShortUrl({url:"/share/topic?topicId="+n},function(e){$(".topic-header-share .share").data("shortUrl",e),$(".topic-header-share .qrcode-img").qrcode({width:128,height:128,text:e}),(0,r.default)({page:"topic",isSyncPage:!0,topicId:n})})}});window.linksRouter=new a,Backbone.history.start({pushState:!0})},{"./views/LinkView":7,"./views/SearchHeaderView":8,"./views/SearchView":9}],2:[function(e,n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,n){var t=new i;t.isDataReady?e&&_.isFunction(e)&&e(t):(t.on("dataReady",function(){e&&_.isFunction(e)&&e(t)}),t.initData(n))};var i=Backbone.Model.extend({defaults:{columnHottestHeight:[0,0,0,0,0],columnLatestHeight:[0,0,0,0,0],pageNumber:1,links:[]},preinitialize:function(){this.on("add",function(){})},initialize:function(){this.isDataReady=!1},parse:function(e){return e.results},parseLinkData:window.CT.preDealLinks,doLike:function(e,n,t,i){function a(e){t&&_.isFunction(t)&&t.call(i,e,!n)}function s(){t&&_.isFunction(t)&&t.call()}n?window.CT.cancelLike({linkId:e},a,s):window.CT.doLike({linkId:e},a,s)},saveLink:function(e,n,t,i){function a(){t&&_.isFunction(t)&&t.call(i,!n)}function s(){t&&_.isFunction(t)&&t.call()}n?window.CT.cancelSaveLink({linkId:e},a,s):window.CT.saveLink({linkId:e},a,s)},getListData:function(e,t,n,i){var a=this,s={},o="";"index"==t.page&&(s.afterTime="more"==n&&e?e.timeIntoPool:0,o="/link/hot"),"zone"==t.page&&("hottest"==t.type?s.afterScore="more"==n&&e?e.score:0:s.afterTime="more"==n&&e?e.actionTime:0,o="/link/"+t.subject+"/"+t.type),"man"==t.page&&(s.afterTime="more"==n&&e?e.actionTime:0,o="/man"),"discovery"==t.page&&(s.page=e.pageNumber?e.pageNumber:t.pageNumber,s.category=t.category,o="/category/list"),"recommend"==t.page&&(o="/recommend/ajax"),"topic"==t.page&&(s.afterTime="more"==n&&e?e.actionTime:0,o="/topic/"+t.topicId+"/link"),$.ajax({url:o,type:"GET",data:s,success:function(e){var n=e&&0<e.length?a.parseLinkData(e,t):[];a.set({links:n,pageNumber:s.page?s.page:1}),a.isDataReady=!0,a.trigger("dataReady")},error:function(e){}})},getSearchData:function(e,i,n,t){var a=this,s={};s.page=i.pageNumber,s.words=i.words,s.searchType=i.searchType?i.searchType:2,s.time=i.time?i.time:"",s.linkType=i.linkType?i.linkType:"ALL",s.subjectId=i.subjectId?i.subjectId:"-1",$.ajax({url:"/search/show",type:"POST",data:s,success:function(e){var n=_.clone(e);if(n.linksList?n.links=a.parseLinkData(n.linksList,i):n.links=[],n.userList||(n.userList=[]),2==s.searchType){var t=n.linksItems?999<n.linksItems?"999+":n.linksItems:0;$("#search_result_num").html(t)}a.set(n),a.isDataReady=!0,a.trigger("dataReady")},error:function(e){}})},fetchMore:function(e,n){var t=this.toJSON().links,i=_.last(t);"search"==e.page?this.getSearchData(i,e,"more",n):this.getListData(i,e,"more",n)},fetchInit:function(e,n){"search"==e.page?this.getSearchData({},e,"init",n):this.getListData({},e,"init",n)},initData:function(e){var n=$(".link-con .link-item").last(),t={timeIntoPool:0<n.length?n.data("timeIntoPool"):0,score:0<n.length?n.data("score"):0,actionTime:0<n.length?n.data("actionTime"):0,pageNumber:0<n.length?2:1};e.isSyncPage&&(this.isDataReady=!0,this.trigger("dataReady")),"search"==e.page?this.getSearchData(t,e,"more"):this.getListData(t,e,"more")}})},{}],3:[function(e,n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LinkCommentOuterTmpl=t.DetailTmpl=void 0,Handlebars.registerHelper("deepTraversal",function e(n){for(var t='<div class="comment-ul">',i=0,a=n.length;i<a;i++){var s=n[i].childs&&0<n[i].childs.length,o=window.CT.getCommentDifferTime(n[i].createTime),r=(n[i].isVote,1==n[i].isVote?"active":""),c=-1==n[i].isVote?"active":"";t+=s?'<div class="comment-li comment-li-'.concat(n[i].id," comment-depth-").concat(n[i].depth,'" data-idx="').concat(n[i].depth,'" >'):'<div class="comment-li noChild comment-li-'.concat(n[i].id," comment-depth-").concat(n[i].depth,'" data-idx="').concat(n[i].depth,'">'),i==n.length-1&&(t+='<div class="last-line"></div>'),t+='<div class="prefix">\n                <div class="vertical-line"></div>\n                <div class="horizontal-line"></div>\n                <div class="add-con">\n                    <div class="min"></div>\n                    <div class="add"></div>\n                </div>\n                <div class="less-con" '.concat(s?'style="display: block;"':"",'>\n                    <div class="add"></div>\n                    <div class="min"></div>\n                </div>\n             </div>'),t+='\n                    <div class="comment-content-con">\n                        <div class="comment-user-card-con " data-jid="'.concat(n[i].jid,'" data-id="').concat(n[i].id,'"></div>\n                        <div class="comment-avatar-con" data-open="/publish/links/').concat(n[i].jid,'" >\n                            <img class="comment-avatar" src="').concat(window.CT.replaceHttps(n[i].user.imgUrl),'" alt="" onerror="javascript:this.src=\'/images/image48-9d05fa83eb.png\';this.onerror=null;">'),n[i].isLandlord&&(t+='<img class="landlord-icon" src="/images/landlord-acbd367b0c.png" alt="">'),t+='</div>\n                        <div class="comment-item-con">\n                            <div class="comment-author-con clearfix">\n                                <a class="comment-author left" href="/publish/links/'.concat(n[i].jid,'" target="_blank">').concat(n[i].user.nick,'</a>\n                                <span class="comment-time left" data-time="').concat(n[i].createTime,'">').concat(o,'评论</span>\n                                <div class="reply-con right clearfix" id="replyCon" data-vote=').concat(n[i].isVote," data-id=").concat(n[i].id," data-self-status=").concat(n[i].selfStatus,'>\n                                    <a class="reply-item hate right ').concat(c,'" href="javascript:;"  >\n                                        <span class="hate-icon"></span>\n                                        <span class="hate-num">').concat(n[i].downs,'</span>\n                                    </a>\n        \n                                    <a class="reply-item like ').concat(r,' right" href="javascript:;" >\n                                        <span class="like-icon"></span>\n                                        <span class="like-num">').concat(n[i].ups,"</span>\n                                    </a>"),6!=n[i].depth&&(t+='<a class="reply-item reply right" href="javascript:;">\n                                    回复\n                            </a>'),t+='<a class="reply-item self right" href="javascript:;" id="self">\n                                        '.concat(n[i].selfStatus?"已":"","私藏\n                                    </a>"),n[i].jid!==window.jid&&(t+='<a class="reply-item report right" href="javascript:;" id="report">\n                                            举报\n            </a>'),t+='</div>\n                            </div>\n                            <div class="comment-content">',2!=n[i].action&&n[i].dissentTag&&(t+='<span class="dissentTag">'.concat(n[i].dissentTag,"</span>")),t+=" ".concat(n[i].content,"\n                            ").concat(n[i].pictureUrl?'\n                                <p class="img-comment-con" >\n                                    <img data-open="'.concat(n[i].pictureUrl,'" src="').concat(window.CT.replaceHttps(n[i].pictureUrl)+"?imageView2/1/w/100/h/100/interlace/1",'" class="img-comment"/>\n                                </p>\n                            '):"","\n                            </div>\n                        </div>\n                          \n        "),t+='\n                <div class="comment-item-area-con comment-item-area-con-'.concat(n[i].id,'" data-id="').concat(n[i].id,'">\n                <div class="comment-item-area ').concat(n[i].commentHavePicture?"comment-item-pic-area":"",'">\n                    <span class="reply-icon-arrow"></span>\n                    <div class="comment-textarea-con clearfix" >\n                        <div class="comment-item-border left comment-img-border " >\n                            <textarea class="comment-item-textarea"></textarea>\n                            <label class="comment-item-placeholder">回复 ').concat(n[i].user.nick,'：</label>\n                            <div class="comment-item-preview-con">\n                                <span class="preview-item-bg-con left">\n                                    <span class="preview-item-bg"></span>\n                                    <span class="progress-item-base">\n                                        <span class="progress-item-percent"></span>\n                                    </span>\n                                </span>\n                                <img class="preview-item-image left"\n                                    src=""\n                                    alt="">\n                                <img class="preview-item-close " src="/images/removeUpload-f46f113509.png" alt="" data-id="').concat(n[i].id,'">\n                            </div>\n                            <div class="comment-item-input-tips">\n                                <span class="can-input-item-text">还可输入</span><span class="over-input-item-text">已超出</span><span class="comment-item-input-num">150</span>个字\n                            </div>\n                        </div>\n                    </div>\n                    \n                </div>\n\n                <div class="comment-btn-con clearfix">\n                    <div class="comment-item-btn btn right disabled">评论</div>\n                    <div class="btn loading-more-img-con comment-loading right">\n                      <span class="bounce bounce1"></span><span class="bounce bounce2"></span><span class="bounce bounce3"></span>\n                    </div>\n                    ').concat(n[i].commentHavePicture?'\n                        <div class="comment-item-image-con right">\n                            <input type="file" id="uploadFile-'.concat(n[i].id,'" class="item-uploadFile"  data-id="').concat(n[i].id,'"/>\n                            <label for="uploadFile-').concat(n[i].id,'">\n                                <span class="comment-item-image-icon right"></span>\n                            </label>\n                        </div>\n                    '):"",'\n                </div>\n                \n                <div class="comment-item-input-error left">1分钟之内不可提交相同评论</div>\n            </div>\n            </div>          \n        '),s&&(t+=e(n[i].childs)),t+="</div>"}return t+="</div>",new Handlebars.SafeString(t)});t.DetailTmpl='\n<div class="comment-ul first-parent">\n    {{#each comments}}\n        <div class="comment-li  {{#unless hasChild}}noChild{{/unless}} comment-li-{{id}} comment-depth-{{depth}}" data-idx="{{depth}}">\n            <div class="comment-content-con">\n                <div class="comment-user-card-con" data-id="{{id}}" data-jid="{{jid}}"></div> \n                <div class="comment-avatar-con" data-open="/publish/links/{{jid}}" >\n                    <img class="comment-avatar" src="{{replaceHttps user.imgUrl}}" alt="" onerror="javascript:this.src=\'/images/image48-9d05fa83eb.png\';this.onerror=null;">\n                    {{#if isLandlord}}\n                        <img class="landlord-icon" src="/images/landlord-acbd367b0c.png" alt="">\n                    {{/if}}\n                </div>\n                \n                <div class="comment-item-con">\n                    <div class="comment-author-con clearfix">\n                        <a class="comment-author left" href="/publish/links/{{jid}}" target="_blank">{{user.nick}}</a>\n                        <span class="comment-time left" data-time="{{createTime}}">{{timeagoComment createTime}}评论</span>\n                        <div class="reply-con right clearfix" id="replyCon" data-vote={{isVote}} data-id={{id}} data-self-status={{selfStatus}}>\n                            <a class="reply-item hate right {{downClass}}" href="javascript:;"  >\n                                <span class="hate-icon"></span>\n                                <span class="hate-num">{{downs}}</span>\n                            </a>\n\n                            <a class="reply-item like {{upClass}} right" href="javascript:;">\n                                <span class="like-icon"></span>\n                                <span class="like-num">{{ups}}</span>\n                            </a>\n\n                            <a class="reply-item reply right" href="javascript:;">\n                                回复\n                            </a>\n                            <a class="reply-item self right" href="javascript:;" id="self">\n                                {{#if selfStatus}}已{{/if}}私藏\n                            </a>\n                            {{#unless isMyself}}\n                                <a class="reply-item report right" href="javascript:;" id="report">\n                                    举报\n                                </a>\n                            {{/unless}}\n                        </div>\n                    </div>\n                    <div class="comment-content">\n                        {{#if isDissentTag}}\n                            <span class="dissentTag">{{dissentTag}} </span>\n                        {{/if}}\n                        {{{content}}}\n                        {{#if pictureUrl}}\n                            <p class="img-comment-con" >\n                                <img data-open="{{pictureUrl}}" src="{{replaceHttps pictureUrl}}?imageView2/1/w/100/h/100/interlace/1" class="img-comment"/>\n                            </p>\n                        {{/if}}\n                    </div>\n                </div>\n                <div class="comment-item-area-con comment-item-area-con-{{id}}" data-id="{{id}}">\n                    <div class="comment-item-area {{#if commentHavePicture}}comment-item-pic-area{{/if}}">\n                        <span class="reply-icon-arrow"></span>\n                        <div class="comment-textarea-con clearfix" >\n                            <div class="comment-item-border left comment-img-border " >\n                                <textarea class="comment-item-textarea"></textarea>\n                                <label class="comment-item-placeholder">回复 {{user.nick}}：</label>\n                                <div class="comment-item-preview-con">\n                                    <span class="preview-item-bg-con left">\n                                        <span class="preview-item-bg"></span>\n                                        <span class="progress-item-base">\n                                            <span class="progress-item-percent"></span>\n                                        </span>\n                                    </span>\n                                    <img class="preview-item-image left"\n                                        src=""\n                                        alt="">\n                                    <img class="preview-item-close " src="/images/removeUpload-f46f113509.png" alt="" data-id="{{id}}">\n                                </div>\n                                <div class="comment-item-input-tips">\n                                    <span class="can-input-item-text">还可输入</span><span class="over-input-item-text">已超出</span><span class="comment-item-input-num">150</span>个字\n                                </div>\n                            </div>\n                        </div>\n                        \n                    </div>\n\n                    <div class="comment-btn-con clearfix">\n                        <div class="comment-item-btn btn right disabled">评论</div>\n                        <div class="btn loading-more-img-con comment-loading right">\n                          <span class="bounce bounce1"></span><span class="bounce bounce2"></span><span class="bounce bounce3"></span>\n                        </div>\n                        {{#if commentHavePicture}}\n                            <div class="comment-item-image-con right">\n                                <input type="file" id="uploadFile-{{id}}" class="item-uploadFile"  data-id="{{id}}"/>\n                                <label for="uploadFile-{{id}}">\n                                    <span class="comment-item-image-icon right"></span>\n                                </label>\n                            </div>\n                        {{/if}}\n                    </div>\n                    <div class="comment-item-input-error left">1分钟之内不可提交相同评论</div>\n                </div>\n\n            </div>\n            {{#if hasChild}}\n                {{deepTraversal childs}}\n            {{/if}}\n        </div>\n    {{/each}}\n</div>\n';t.LinkCommentOuterTmpl='\n    <div class="link-comment-area">\n\n       \n        \n        \x3c!-- 关闭评论 --\x3e\n        {{#if noComments}}\n            <div class="comment-expire-tips" >\n                已关闭评论 <a href="/link/{{linkId}}?mark=true" target="_blank" class="toComment hideToComment right">去评论页面 <span class="double-link-icon"></span> </a>\n            </div>\n        {{/if}}\n        \x3c!-- 过期 --\x3e\n        {{#if linkExpire}}\n            <div class="comment-expire-tips" >\n                话题跟帖开放时间已过 <a href="/link/{{linkId}}?mark=true" target="_blank" class="toComment hideToComment right">去评论页面 <span class="double-link-icon"></span> </a>\n            </div>\n        {{/if}}\n        \n         {{#unless linkExpire}}        \n            <div class="link-comment-loading">\n                <span class="link-loading-icon small"><span class="rect rect1"></span><span class="rect rect2"></span><span class="rect rect3"></span></span>\n            </div>\n        {{/unless}}\n\n\n        <div class="comment-result-con">\n            {{#if isNormal}}\n                <div class="comment-input-con clearfix">\n                    <img class="comment-avatar left" src="{{#if imgUrl}}{{replaceHttps imgUrl}}{{/if}}{{#unless imgUrl}}/images/image48-9d05fa83eb.png{{/unless}}" alt="" >\n                    \n                    <div class="comment-border left {{#if commentHavePicture}}comment-img-border{{/if}}">\n                        <textarea class="comment-textarea"></textarea>\n                        <label class="comment-top-placeholder">成熟的小建议：友善发言，言之有物</label>\n                        <div class="comment-preview-con">\n                  <span class="preview-bg-con left">\n                    <span class="preview-bg"></span>\n                    <span class="progress-base">\n                        <span class="progress-percent"></span>\n                    </span>\n                  </span>\n                            <img class="preview-image left" src="" alt="">\n                            <img class="preview-close " src="/images/removeUpload-f46f113509.png" alt="">\n                        </div>\n                        <div class="comment-input-tips">\n                            <span class="can-input-text">还可输入</span><span class="over-input-text">已超出</span><span class="comment-input-num">150</span>个字\n                        </div>\n                    </div>\n                    <div class="comment-btn btn right disabled">\n                        评论\n                    </div>\n                    <div class="btn loading-more-img-con comment-loading right">\n                        <span class="bounce bounce1"></span><span class="bounce bounce2"></span><span class="bounce bounce3"></span>\n                    </div>\n                    {{#if commentHavePicture}}\n                        <div class="comment-item-image-con right">\n                            <input type="file" id="uploadFile-{{linkId}}" class="item-uploadFile"  data-id="{{id}}"/>\n                            <label for="uploadFile-{{linkId}}">\n                                <span class="comment-item-image-icon right"></span>\n                            </label>\n                        </div>\n                    {{/if}}\n    \n                </div>\n                <div class="comment-input-error">\n                    1分钟之内不可提交相同评论\n                </div>\n            \n            \x3c!-- 抢沙发 --\x3e\n                <div class="comment-no-tips">\n                    还没有评论哦，赶紧当第一个评论者吧！ <a href="/link/{{linkId}}?mark=true" target="_blank" class="toComment right">去评论页面 <span class="double-link-icon"></span> </a>\n                </div>\n                \n            {{/if}}\n            \n            {{#unless linkExpire}}\n                <div class="comment-container" >\n                    <div class="nav-bar clearfix">\n                        <a class="nav-item active hot-sort left">\n                            热度排序\n                        </a>\n                        <a class="nav-item ml36 time-sort left">\n                            时间排序\n                        </a>\n                        <a href="/link/{{linkId}}?mark=true" target="_blank" class="toComment right">去评论页面 <span class="double-link-icon"></span> </a>\n                    </div>\n                    <div class="comment-list-loading-con">\n                        <span class="link-loading-icon small"><span class="rect rect1"></span><span class="rect rect2"></span><span class="rect rect3"></span></span>\n                    </div>\n                    <div class="comment-con"></div>\n                    <div class="collapse-con">\n                        <span class="collapse">收起 <img src="/images/arrow-up-06fa8a3a79.png" class="double-arrow-icon-up"></span>\n                    </div>\n                </div>\n            {{/unless}}\n\n            \n\n            \n\n\n\n        </div>\n\n    </div>\n'},{}],4:[function(e,n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LinkNullTmpl=t.picItemTmpl=void 0;t.picItemTmpl='\n    {{#each links}}\n        <div id="pic_{{id}}" class="waterfall-item link-item link-item-{{id}} pic-item left {{#if ../isVideo}} video{{/if}}" data-id="{{id}}"\n        data-has-saved="{{hasSaved}}"\n        data-has-uped="{{hasUped}}"\n        data-time-into-pool="{{timeIntoPool}}"\n        data-action-time="{{actionTime}}"\n        data-score="{{score}}"    >\n            <a id="pic_image_wrap_{{id}}" class="pic-image-wrap {{#if imgUrlWidthNew}}{{else}} normal-image{{/if}}" href="{{getLinkUrl this}}" target="_blank">\n                {{#if ../isVideo}} \n                    <img class="matching" width="{{imgUrlWidthNew}}" height="{{imgUrlHeightNew}}" src="{{replaceHttps imgPicUrl}}" />                       \n                {{else}}\n                    <img class="{{isImageScale imgUrl}} matching" width="{{imgUrlWidthNew}}" height="{{imgUrlHeightNew}}" src="{{replaceHttps imgPicUrl}}" />                        \n                {{/if}}\n                {{isShow this ../isVideo}}\n            </a>\n            <div class="link-info-con">\n                <div class="link-detail">                    \n                    {{#if hasTopic}}\n                        <a class="topic-con clearfix" href="/topic/{{topicId}}" target="_blank">\n                            <img class="left topic-icon" src="/images/mark/topic_icon-d15bdf1385.png" alt="">\n                            <span class="left">{{getTopicName topicName}}</span>                            \n                        </a>\n                    {{/if}}\n                    <a class="link-title link-statistics" data-id="{{id}}" href="{{getLinkUrl this}}" target="_blank">\n                        {{getVideoTitle title hasTopic ../isVideo}}\n                    </a>\n                </div>\n                <div class="operate-author-con">\n                    <div class="operate-con clearfix">\n                        <a class="operate-item recommend left clearfix {{getOperateClassName hasUped}}" href="javascript:;">\n                            <span class="recommend-icon left">\n                                <span class="recommend-icon-img"></span>\n                                <span class="recommend-icon-img-animate"></span>\n                            </span>\n                            <span class="recommend-num left">{{getThousand ups}}</span>\n                        </a>\n                        <a class="operate-item comment left clearfix" href="/link/{{id}}?mark=true" target="_blank">\n                            <span class="comment-icon left"></span>\n                            {{#if hasComments}}\n                                <span class="comment-num left">{{getThousand commentsCount}}</span>\n                            {{/if}}                        \n                        </a>\n                        <a class="operate-item save left {{getOperateClassName hasSaved}}"  href="javascript:;">\n                            <span class="save-icon">\n                                <span class="save-icon-img"></span>\n                                <span class="save-icon-img-animate"></span>\n                            </span>\n                        </a>\n                        <a class="operate-item share active share-level left" href="javascript:;"\n                            data-title="{{title}}"\n                            data-content="{{content}}"\n                            data-pic="{{originalImgUrl}}"\n                            data-subject="{{subject}}"\n                            data-id="{{id}}"\n                            data-url="/share/link?link_id={{id}}">\n                            <span class="share-icon"></span>\n                            <span class="share-hover-con">\n                                <img class="share-down-angle-icon" src="/images/share-down-angle-14b405556e.png" />\n                                <span class="share-hover-con-bg">\n                                    <span class="share-inner-icon weixin-icon">\n                                        <span class="qrcode-con">\n                                            <img class="down-angle-icon" src="/images/down-angle2-8231dd51f8.png" />\n                                            <span class="qrcode-img"></span>\n                                        </span>\n                                    </span>    \n                                    <span class="share-inner-icon weibo-icon"></span>\n                                    <span class="share-inner-icon dou-icon"></span>\n                                    <span class="share-inner-icon qq-icon"></span>    \n                                    <span class="share-inner-icon link-icon"></span>\n                                </span>\n                            </span>\n                        </a>\n                    </div>\n                    <div class="author-con">                \n                        <div class="author-avatar-name pic" data-id="{{id}}" data-jid="{{submittedUser.jid}}" data-jump="/publish/links/{{submittedUser.jid}}">\n                            <div class="clearfix">\n                                <img class="left author-avatar" src="{{replaceHttps submittedUser.imgUrl}}" alt="" data-jump="/publish/links/{{submittedUser.jid}}"/>\n                                <div class="left">\n                                    <div class="author-name">{{submittedUser.nick}}</div>\n                                    <div class="time-enter timeago"><span data-time="{{createTime}}" class="time-update">{{timeago createTime}}</span>发布</div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n        </div>\n    {{/each}}';t.LinkNullTmpl='\n    <div class="link-null">         \n         {{#if showNoSearch}}\n            <div class="search-null">\n                <img class="search-null-icon" src="/images/search-null-5943748ffd.png"/>\n                <div class="link-null-msg">{{msg}}</div>\n            </div>\n         {{/if}}\n         {{#if showNoData}}<img class="no-data-icon" src="/images/no-data-5021edcae4.png"/>{{/if}}\n    </div>',Handlebars.registerHelper("isShow",function(e,n){var t="";n?(t+='<div class="video-play-mask"></div><img class="video-play" src="/images/video/play-6bd2287cd8.png"/>',e.videoDuration&&(t+='<div class="pic-type pic-type-bottom pic-type-left">'+(9<parseInt(e.videoDuration/60)?parseInt(e.videoDuration/60):"0"+parseInt(e.videoDuration/60))+":"+(9<e.videoDuration%60?e.videoDuration%60:"0"+e.videoDuration%60)+"</div>")):(e.domain&&!~e.domain.toLocaleLowerCase().indexOf("chouti.com")&&(t+='<div class="pic-from">'+e.domain+"</div>"),e.multigraph&&e.multigraphList&&1<e.multigraphList.length&&(t+='<div class="pic-type pic-type-top pic-type-left">'+e.multigraphList.length+"图</div>"),e.imgPicUrl&&-1<e.imgPicUrl.indexOf(".gif")&&(t+='<div class="pic-type pic-type-top pic-type-right">GIF</div>'));return new Handlebars.SafeString(t)}),Handlebars.registerHelper("getVideoTitle",function(e,n,t){var i=n&&t?40:50;return e.length>i?e.slice(0,i)+"...":e})},{}],5:[function(e,n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SearchHeaderTmpl=t.SearchUserListTmpl=void 0;t.SearchUserListTmpl='\n    {{#each userList}}\n        <div class="user-items clearfix" >\n            <img class="left user-pic" src="{{replaceHttps imgUrl}}" data-jump="/publish/links/{{jid}}"/>\n            <div class="left user-info">\n                <div class="name" data-jump="/publish/links/{{jid}}">{{{snick}}}</div>\n                <div class="coments-items">\n                    <a href="/publish/links/{{jid}}">发布<span>{{getThousand submittedCount}}</span></a>\n                    <a href="/voted/links/{{jid}}">推荐<span>{{getThousand likeCount}}</span></a>\n                    <a href="/publish/comments/{{jid}}">评论<span>{{getThousand commentCount}}</span></a>\n                </div>\n            </div>\n            {{userAttention attentionState jid}}\n        </div>  \n    {{/each}}\n';t.SearchHeaderTmpl='\n    <div class="search-header-top clearfix">\n        <span class="left search-type {{isActive searchType \'2\'}}" data-type="2">发布</span>\n        <span class="left search-type {{isActive searchType \'3\'}}" data-type="3">用户</span>\n        <div class="right search-input-wrap">\n            <div class="search-input-con clearfix">\n                <input type="text" class="left search-input-text" placeholder="搜索" value="{{words}}">\n                <div class="right search-input-btn">\n                    <span class="search-input-btn-icon"></span>\n                    \x3c!--<img class="search-input-btn-icon" src="/images/search-7acb7b9349.png"/>--\x3e\n                </div>\n            </div>\n            {{#if showSearchHistory}}\n                <div class="search-history">\n                    <div class="search-history-con">\n                        {{#each searchHistory}}\n                            <div class="search-history-item clearfix">\n                                <span class="left search-history-text">{{this}}</span>\n                                <span class="right search-history-close">\n                                    <img src="/images/close-gray-c7f3d10860.png"/>\n                                </span>\n                            </div>\n                        {{/each}}                        \n                    </div>\n                    <div class="delete-history clearfix">\n                        <span class="right">清空搜索记录</span>\n                        <img class="right remove-icon" src="/images/search/search-remove-706e04df87.png"/>\n                    </div>\n                </div>\n            {{/if}}\n        </div>\n    </div>\n    {{#if selectShow}}\n        <div class="search-select-group clearfix">\n            <div class="left search-select-item form-item clearfix">\n                <div class="left search-select-name">所属分类：</div>\n                <div class="left search-select-con select-con" data-name="subjects">\n                    <div class="select-current select-country clearfix">\n                        <span class="current-country">{{selectedSubjects.name_cn}}</span>\n                        <img src="/images/triangle2-c9486adb57.png" class="select-icon" />\n                    </div>\n                    <ul class="select-ul">\n                        {{#each subjects}}\n                            <li class="select-li {{isActive ../selectedSubjects.id id}}" data-id="{{id}}" data-value="{{name_cn}}"><span>{{name_cn}}</span></li>\n                        {{/each}}\n                    </ul>\n                </div>\n            </div>\n            <div class="left search-select-item form-item clearfix">\n                <div class="left search-select-name">发布时间：</div>\n                <div class="left search-select-con select-con" data-name="publishTime">\n                    <div class="select-current select-country clearfix">\n                        <span class="current-country">{{selectedPublishTime.name}}</span>\n                        <img src="/images/triangle2-c9486adb57.png" class="select-icon" />\n                    </div>\n                    <ul class="select-ul">\n                        {{#each publishTime}}\n                            <li class="select-li {{isActive ../selectedPublishTime.id id}}" data-id="{{id}}" data-value="{{name}}"><span>{{name}}</span></li>\n                        {{/each}}\n                    </ul>\n                </div>\n            </div>\n            <div class="left search-select-item form-item clearfix">\n                <div class="left search-select-name">其他条件筛选：</div>\n                <div class="left search-select-con select-con" data-name="otherOption">\n                    <div class="select-current select-country clearfix">\n                        <span class="current-country">{{selectedOtherOption.name}}</span>\n                        <img src="/images/triangle2-c9486adb57.png" class="select-icon" />\n                    </div>\n                    <ul class="select-ul">\n                        {{#each otherOption}}\n                            <li class="select-li {{isActive ../selectedOtherOption.id id}}" data-id="{{id}}" data-value="{{name}}"><span>{{name}}</span></li>\n                        {{/each}}\n                    </ul>\n                </div>\n            </div>\n            <span class="right search-result">共<span id="search_result_num">{{searchNum}}</span>条搜索结果</span>\n        </div>\n    {{/if}}\n',Handlebars.registerHelper("isActive",function(e,n){return e==n?"active":""})},{}],6:[function(e,n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=e("../template/LinkCommentTmpl");function a(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function t(e,n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.$linkItem=e,this.params=n,this.offset=this.$linkItem.offset(),this._renderLayout(),this.display=!0,this.$comment=e.find(".comment"),this.$commentNum=e.find(".comment-num"),this.$inputTips=e.find(".comment-input-tips"),this.$canInputText=e.find(".can-input-text"),this.$overInputText=e.find(".over-input-text"),this.$restNum=e.find(".comment-input-num"),this.$collapseCon=e.find(".collapse-con"),this.$textArea=e.find(".comment-textarea"),this.$topPlaceholder=e.find(".comment-top-placeholder"),this.$input=e.find(".comment-input"),this.$commentBorder=e.find(".comment-border"),this.$previewCon=e.find(".comment-preview-con"),this.$previewBgCon=e.find(".preview-bg-con"),this.$percent=e.find(".progress-percent"),this.$previewClose=e.find(".preview-close"),this.$previewImage=e.find(".preview-image"),this.$commentError=e.find(".comment-input-error"),this.$commentBtn=e.find(".comment-btn"),this.comments={},this.isLoading=!1,this.hasImg=!1,this.waitImgUrl="",this.textOver=!1,this.noOne=!0,this.isInit=!0,this.url=window.URL||window.webkitURL,this.currentImgFile="",this._bindEvents.bind(this)()}var e,n,i;return e=t,(n=[{key:"init",value:function(e,n){this.$linkItem=e,this.params=n,this.display=!0,this.offset=e.offset(),this._renderLayout(),this.$comment=e.find(".comment"),this.$commentNum=e.find(".comment-num"),this.$inputTips=e.find(".comment-input-tips"),this.$canInputText=e.find(".can-input-text"),this.$overInputText=e.find(".over-input-text"),this.$restNum=e.find(".comment-input-num"),this.$collapseCon=e.find(".collapse-con"),this.$textArea=e.find(".comment-textarea"),this.$topPlaceholder=e.find(".comment-top-placeholder"),this.$input=e.find(".comment-input"),this.$commentBorder=e.find(".comment-border"),this.$previewCon=e.find(".comment-preview-con"),this.$previewBgCon=e.find(".preview-bg-con"),this.$percent=e.find(".progress-percent"),this.$previewClose=e.find(".preview-close"),this.$previewImage=e.find(".preview-image"),this.$commentError=e.find(".comment-input-error"),this.$commentBtn=e.find(".comment-btn"),this.comments={},this.isLoading=!1,this.hasImg=!1,this.waitImgUrl="",this.textOver=!1,this.noOne=!0,this.isInit=!0,this.url=window.URL||window.webkitURL,this.currentImgFile=""}},{key:"_renderLayout",value:function(){if(0<this.$linkItem.find(".link-comment-area").length)this.$linkItem.find(".link-comment-area").remove();else{var e=Handlebars.compile(l.LinkCommentOuterTmpl);this.$linkItem.append(e(this.params)),this.$LinkCommentArea=this.$linkItem.find(".link-comment-area").show(),this.params.linkExpire?this.$linkItem.find(".comment-result-con").show():(this.$loading=this.$LinkCommentArea.find(".link-comment-loading"),this.$commentResultCon=this.$LinkCommentArea.find(".comment-result-con"),this.$listLoading=this.$LinkCommentArea.find(".comment-list-loading-con"),this.$commentContainer=this.$LinkCommentArea.find(".comment-container"),this.$commentCon=this.$LinkCommentArea.find(".comment-con"),this.$noTips=this.$LinkCommentArea.find(".comment-no-tips"),this.$hotSort=this.$LinkCommentArea.find(".hot-sort"),this.$timeSort=this.$LinkCommentArea.find(".time-sort"),this.fetchComments())}}},{key:"fetchComments",value:function(i){var a=this;$.ajax({url:"/comments/show",type:"GET",data:{id:a.params.linkId,sort:a.params.sort},success:function(e){var n=e.commentList,t=e.count;a.$loading.hide(),a.$commentResultCon.show(),_.isEmpty(n)||_.isArray(n)&&0===n.length?(a.$LinkCommentArea.find(".comment-no-tips").show(),a._calculateAllOffset()):(a.deepDealData(n),a.isInit&&(a.noOne=!1),a.$LinkCommentArea.find(".hideToComment").hide(),a.$commentNum=a.$comment.find(".comment-num"),0<a.$commentNum.length?a.$comment.find(".comment-num").text(t):0<t&&(a.$comment.append('<span class="comment-num left">'+t+"</span>"),a.$commentNum=a.$comment.find(".comment-num")),a._render(n)),_.isFunction(i)&&i()},error:function(e){400===e.code&&"这条发布已经删除"===e.msg?a.$linkItem.remove():a.$LinkCommentArea.hide()}})}},{key:"deepDealData",value:function(e){var t=this;_.each(e,function(e){if(e.hasChild=e.childs&&0<e.childs.length,e.isOperated=0==e.isVote,e.isUp=1==e.isVote,e.isDown=-1==e.isVote,e.upClass=1==e.isVote?"active":"",e.downClass=-1==e.isVote?"active":"",e.isLandlord=t.params.submitJid===e.jid,e.isMyself=window.jid===e.jid,e.commentHavePicture=t.params.commentHavePicture,e.isDissentTag=!(2==e.action||!e.dissentTag),e.user){var n=e.user.imgUrl;n&&"http://img3.chouti.com/default_avatar_img.png"!==n||(n="/images/image48-9d05fa83eb.png"),e.user.imgUrl=n}e.hasChild&&t.deepDealData(e.childs)})}},{key:"_render",value:function(e){var n=Handlebars.compile(l.DetailTmpl),t={comments:e};this.$linkItem.find(".comment-con").html(n(t)),this.$commentContainer.show(),this._calculateAllOffset(),this.isInit=!1,this.bindNewEvents()}},{key:"_calculateAllOffset",value:function(){_.each(window.commentJc,function(e,n){e._calculateOffset.bind(e)()})}},{key:"_calculateOffset",value:function(){this.offset=this.$linkItem.offset();var e=this.$linkItem.outerHeight();this.coordinate={min:this.offset.top,max:this.offset.top+e}}},{key:"_bindEvents",value:function(){var c=this;c.$linkItem.on("click",".less-con",function(e){var n=$(e.target),t=n.hasClass("prefix")?n:n.parents(".prefix"),i=t.parent(),a=i.children(".comment-ul"),s=t.find(".less-con"),o=t.find(".add-con");s.hide(),o.show(),i.addClass("noChild"),a.hide(),c._calculateAllOffset()}),c.$linkItem.on("click",".add-con",function(e){var n=$(e.target),t=n.hasClass("prefix")?n:n.parents(".prefix"),i=t.parent(),a=i.children(".comment-ul"),s=t.find(".less-con"),o=t.find(".add-con");s.show(),o.hide(),i.removeClass("noChild"),a.show(),c._calculateAllOffset()}),c.$linkItem.on("click",".like",function(e){var n=$(e.target),t=n.hasClass("like")?n:n.parents(".like"),i=t.parent(),a=t.children(".like-num"),s=(Number(a.text()),i.data("id")),o=i.data("vote");return window.loginedUser?-1!==o&&void(1===o?window.CT.doCancelCommentVote({id:s,vote:1},function(e){t.removeClass("active"),a.text(e.ups),i.data("vote",0)}):window.CT.doCommentVote({id:s,vote:1},function(e){t.addClass("active"),a.text(e.ups),i.data("vote",1)})):(window.CT.showLogin(),!1)}),c.$linkItem.on("click",".hate",function(e){var n=$(e.target),t=n.hasClass("hate")?n:n.parents(".hate"),i=t.parent(),a=t.children(".hate-num"),s=(Number(a.text()),i.data("id")),o=i.data("vote");return window.loginedUser?1!==o&&void(-1===o?window.CT.doCancelCommentVote({id:s,vote:-1},function(e){t.removeClass("active"),a.text(e.downs),i.data("vote",0)}):window.CT.doCommentVote({id:s,vote:-1},function(e){t.addClass("active"),a.text(e.downs),i.data("vote",-1)})):(window.CT.showLogin(),!1)}),c.$linkItem.on("click",".time-sort",function(e){if($(e.target).hasClass("active"))return!1;c.$hotSort.removeClass("active"),c.$timeSort.addClass("active"),c.$commentCon.hide(),c.$collapseCon.hide(),c.$listLoading.show(),c.params.sort=0,c.fetchComments(function(){c.$commentCon.show(),c.$collapseCon.show(),c.$listLoading.hide(),c.bindNewEvents(),c._calculateAllOffset()})}),c.$linkItem.on("click",".hot-sort",function(e){if($(e.target).hasClass("active"))return!1;c.$timeSort.removeClass("active"),c.$hotSort.addClass("active"),c.$commentCon.hide(),c.$collapseCon.hide(),c.$listLoading.show(),c.params.sort=1,c.fetchComments(function(){c.$commentCon.show(),c.$collapseCon.show(),c.$listLoading.hide(),c.bindNewEvents(),c._calculateAllOffset()})}),c.$linkItem.on("click",".comment-btn",function(e){c.actionParentComment(e)}),c.$linkItem.on("click",".collapse-con",function(e){c.toggleComment()}),c.$linkItem.on("click",".reply-item.report",function(e){var n=$(e.target).parent(".reply-con").data("id");if(!window.loginedUser)return window.CT.showLogin(),!1;window.CT.report({type:4,commentsId:n})}),c.$linkItem.on("click",".self",function(e){var n=$(e.target),t=n.hasClass("self")?n:n.parents(".self"),i=t.parent(),a=i.data("id"),s=i.data("selfStatus");if(!window.loginedUser)return window.CT.showLogin(),!1;s?window.CT.doCancelSaveComment({commentId:a},function(){window.CT.showTopTips("success","取消私藏成功"),t.text("私藏"),i.data("selfStatus",!1)}):window.CT.doSaveComment({commentId:a},function(){window.CT.showTopTips("success","私藏成功"),t.text("已私藏"),i.data("selfStatus",!0)})}),c.$linkItem.on("click",".reply",function(e){e.stopPropagation(),e.preventDefault();var n=$(e.target),t=(n.hasClass("reply")?n:n.parents(".reply")).parent(),i=t.parent().parent(),a=i.siblings(".comment-item-area-con"),s=(a.children(".comment-item-area"),a.find(".comment-item-textarea")),o=i.find(".comment-item-placeholder"),r=t.data("id");t.data("selfStatus");if(!window.loginedUser)return window.CT.showLogin(),!1;if(1!=window.loginedUser.complateReg)return!!window.CT.isBindPhone()&&(window.noComments?(window.showTopTips("warning","该发布已关闭评论"),!1):void("block"===a.css("display")?a.hide():(0<$.trim(s.val()).length?o.hide():o.show(),$(".comment-item-area-con").hide(),a.show(),s.focus(),c.resetItemErrorTips(r),c._calculateAllOffset())));return window.CT.showRegisterNext&&_.isFunction(window.CT.showRegisterNext)?window.CT.showRegisterNext({modify:!0}):window.CT.showTopTips("warning","请先完善信息"),!1}),c.$linkItem.on("click",".comment-border",function(e){e.stopPropagation();var n=$(this).hasClass("focus");if(!window.loginedUser)return window.CT.showLogin(),c.$textArea.blur(),c.$input.blur(),!1;if(1==window.loginedUser.complateReg){return window.CT.showRegisterNext&&_.isFunction(window.CT.showRegisterNext)?window.CT.showRegisterNext({modify:!0}):window.CT.showTopTips("warning","请先完善信息"),c.$textArea.blur(),c.$input.blur(),!1}if(n)c.$textArea.focus();else{if(!window.CT.isBindPhone())return c.$textArea.blur(),c.$input.blur(),!1;c.activeCommentArea(),c.$textArea.focus(),c._calculateAllOffset()}}),c.$linkItem.on("click",".comment-image-con",function(e){if(e.stopPropagation(),!window.loginedUser)return window.CT.showLogin(),!1;if(1==window.loginedUser.complateReg){return window.CT.showRegisterNext&&_.isFunction(window.CT.showRegisterNext)?window.CT.showRegisterNext({modify:!0}):window.CT.showTopTips("warning","请先完善信息"),!1}}),c.$linkItem.on("blur",".comment-textarea",function(e){var n=$(this);$.trim(n.val())||c.hasImg||c.hideCommentArea()}),c.$linkItem.on("keydown",".comment-textarea",function(e){e.ctrlKey&&13==e.keyCode&&$(this).parent().parent().find(".comment-btn").click()}),c.$linkItem.on("input propertychange",".comment-textarea",function(e){var n=$(this),t=$.trim(n.val()).length,i=Math.floor(150-t),a=n.parent().find(".comment-input-tips");if(0==t)return c.hasImg?c.activeCommentBtn():c.disableCommentBtn(),c.$restNum.text(Math.abs(i)),c.$topPlaceholder.show(),a.removeClass("over"),c.resetErrorTips(),!1;i<0?(c.textOver=!0,c.$canInputText.hide(),c.$overInputText.show(),a.addClass("over"),c.disableCommentBtn()):(a.removeClass("over"),c.$canInputText.show(),c.$overInputText.hide(),c.textOver=!1,c.activeCommentBtn()),c.$topPlaceholder.hide(),c.$restNum.text(Math.abs(i))}),c.bindNewEvents(),c.$previewClose.on("click",function(e){c.hidePreview();var n=$.trim(c.$textArea.val());(n||c.hasImg)&&n.length<=150?c.activeCommentBtn():c.disableCommentBtn()})}},{key:"bindNewEvents",value:function(){var p=this;$(".item-uploadFile").on("change",function(e){e.stopPropagation();var i=$(e.target),a=i.data("id"),n=$(".comment-item-area-con-"+a),s=n.find(".comment-item-textarea"),o=n.find(".preview-item-image"),t=i[0].files;if(p.resetItemErrorTips(a),!window.loginedUser)return window.CT.showLogin(),!1;if(1==window.loginedUser.complateReg){return window.CT.showRegisterNext&&_.isFunction(window.CT.showRegisterNext)?window.CT.showRegisterNext({modify:!0}):window.CT.showTopTips("warning","请先完善信息"),!1}if(!window.CT.isBindPhone())return!1;var r=t[0],c=this.value.toLowerCase().split(".").splice(-1)[0];if(!new RegExp("(jpg|gif|png|jpeg)","g").test(c))return p.showItemErrorTips("图片格式不支持",a),!1;if(10485760<r.size)return p.showItemErrorTips("图片大小不得超过10M",a),!1;p.resetItemErrorTips(a);var l=new FormData;l.append("file",r),p.comments[""+a]={isLoading:!0,hasImg:!1,currentImgFile:r,textOver:!1,waitImgUrl:""},p.showItemPreviewCon(a),p.itemProgressing(a),window.CT.doUpload(l,function(e){var n=_.isArray(e)?window.CT.replaceHttps(e[0].imgUrl):"";p.comments[""+a]={isLoading:!1,hasImg:!0,waitImgUrl:n,currentImgFile:r},o.attr("src",n+"?imageView2/1/w/100/h/100/interlace/1"),i.val(""),i.blur();var t=$.trim(s.val());(t||p.comments[""+a].hasImg)&&t.length<=150?p.activeItemCommentBtn(a):p.disableItemCommentBtn(a)})}),$(".comment-item-textarea").on("blur",function(e){$(this).parent().parent().parent().parent().find(".comment-item-area").removeClass("focus")}),$(".comment-item-textarea").on("focus",function(e){$(this).parent().parent().parent().parent().find(".comment-item-area").addClass("focus")}),$(".comment-item-textarea").on("keydown",function(e){e.ctrlKey&&13==e.keyCode&&$(this).parent().parent().parent().parent().find(".comment-item-btn").click()}),$(".comment-item-textarea").on("input propertychange",function(e){var n=$(this),t=n.parent().parent().parent().parent(),i=t.find(".comment-item-input-tips"),a=t.find(".can-input-item-text"),s=t.find(".over-input-item-text"),o=t.find(".comment-item-input-num"),r=t.find(".comment-item-placeholder"),c=t.data("id"),l=$.trim(n.val());_.isEmpty(p.comments[""+c])&&(p.comments[""+c]={isLoading:!1,hasImg:!1,textOver:!1,waitImgUrl:"",currentImgFile:""});var m=l.length,d=Math.floor(150-m);if(0==m)return p.comments[""+c].hasImg?p.activeItemCommentBtn(c):p.disableItemCommentBtn(c),o.text(Math.abs(d)),i.removeClass("over"),r.show(),p.resetItemErrorTips(c),!1;d<0?(p.comments[""+c].textOver=!0,a.hide(),s.show(),i.addClass("over"),p.disableItemCommentBtn(c)):(a.show(),s.hide(),p.comments[""+c].textOver=!1,i.removeClass("over"),p.activeItemCommentBtn(c)),r.hide(),o.text(Math.abs(d))}),window.CT.generateQrcode(),$(".comment-container").on("click",".comment-item-btn",function(e){p.actionChildComment(e)}),$(".comment-container").on("click",".comment-item-border",function(e){$(this).find(".comment-item-textarea").focus()}),$(".comment-container").on("click",".preview-item-close ",function(e){var n=$(e.target).data("id");p.hideItemPreview(n);var t=$(".comment-item-area-con-"+n).find(".comment-item-textarea"),i=$.trim(t.val());(i||p.comments[""+n].hasImg)&&i.length<=150?p.activeItemCommentBtn(n):p.disableItemCommentBtn(n)}),$("body").on("click",".main, .extra, .dialog-container, .mask, .preview-slot",function(e){e.stopPropagation()}),$("#uploadFile-"+p.params.linkId).off().on("change",function(e){if(p.resetErrorTips(),!window.loginedUser)return window.CT.showLogin(),!1;if(1==window.loginedUser.complateReg){return window.CT.showRegisterNext&&_.isFunction(window.CT.showRegisterNext)?window.CT.showRegisterNext({modify:!0}):window.CT.showTopTips("warning","请先完善信息"),!1}if(!window.CT.isBindPhone())return!1;var n=$(e.target)[0].files;p.currentImgFile=n[0];var t=this.value.toLowerCase().split(".").splice(-1)[0];if(!new RegExp("(jpg|gif|png|jpeg)","g").test(t))return p.showErrorTips("图片格式不支持"),!1;if(10485760<p.currentImgFile.size)return p.showErrorTips("图片大小不得超过10M"),!1;p.resetErrorTips();var i=new FormData;i.append("file",p.currentImgFile),p.activeCommentArea(),p.isLoading=!0,p.hasImg=!1,p.showPreviewCon(),p.progressing(),window.CT.doUpload(i,function(e){p.hasImg=!0,p.isLoading=!1;var n=_.isArray(e)?window.CT.replaceHttps(e[0].imgUrl):"";p.waitImgUrl=n,p.$previewImage.attr("src",n+"?imageView2/1/w/100/h/100/interlace/1"),$("#uploadFile-"+p.params.linkId).val(""),$("#uploadFile-"+p.params.linkId).blur();var t=$.trim(p.$textArea.val());(t||p.hasImg)&&t.length<=150?p.activeCommentBtn():p.disableCommentBtn()})})}},{key:"toggleComment",value:function(){0<this.$linkItem.find(".link-comment-area").length&&(this.$linkItem.find(".link-comment-area").hide().remove(),window.scrollTo(0,this.offset.top-300))}},{key:"checkBeforeComment",value:function(e,n,t){return!e&&(!this.textOver&&(this.resetErrorTips(),!window.noComments&&(window.loginedUser?!!window.CT.isBindPhone()&&!window.CT.isUserBan():(window.CT.showLogin(),!1))))}},{key:"actionChildComment",value:function(e){e.stopPropagation();var o=this,r=$(e.target),n=r.hasClass("disable")||r.hasClass("disabled"),c=r.siblings(".comment-loading"),t=r.parent().parent(),i=t.parents(".comment-li").eq(0),a=(t.parents(".comment-ul").eq(0),t.find(".comment-item-textarea")),l=i.data("idx"),m=t.data("id");if(!o.checkBeforeComment(n,!0,m))return!1;r.hide(),c.show();var s=$.trim(a.val()),d=o.comments[""+m].waitImgUrl;window.CT.doComment({content:s,linkId:o.params.linkId,parentId:m,pictureUrl:d},function(e){var n=0==e.isVote,t=1==e.isVote?"active":"",i=-1==e.isVote?"active":"",a=o.$commentNum.text();if(a){var s=Number(a);o.$commentNum.text(s+1)}else o.$commentNum.text(0);o.addChildComment(e,n,t,i,m,l),o.bindNewEvents(),o.resetItemCommentArea(m),r.show(),c.hide(),o._calculateAllOffset()},function(e){r.show(),c.hide(),200!=e.code&&(1===e.errorType?window.showTopTips("error",e.msg):o.showItemErrorTips(e.msg,m))})}},{key:"actionParentComment",value:function(e){var o=this,r=$(e.target),c=r.siblings(".comment-loading"),n=r.hasClass("disable")||r.hasClass("disabled");if(!o.checkBeforeComment(n))return!1;var t=o.$textArea,i=o.$linkItem.data("id"),a=$.trim(t.val()),s=o.waitImgUrl;r.hide(),c.show(),window.CT.doComment({content:a,linkId:i,parentId:0,pictureUrl:s},function(e){r.show(),c.hide();var n=0==e.isVote,t=1==e.isVote?"active":"",i=-1==e.isVote?"active":"",a=o.$commentNum.text();if(a){var s=Number(a);o.$commentNum.text(s+1)}else o.$comment.append('<span class="comment-num left">1</span>'),o.$commentNum=o.$comment.find(".comment-num");o.addParentComment(e,n,t,i),o.bindNewEvents(),o.resetCommentArea(),o._calculateAllOffset()},function(e){r.show(),c.hide(),200!=e.code&&(1===e.errorType?window.showTopTips("error",e.msg):o.showErrorTips(e.msg))})}},{key:"addParentComment",value:function(e,n,t,i){var a=this,s=_.extend(e,{isOperated:n,upClass:t,downClass:i});s.isLandlord=a.params.submitJid===s.jid,s.isMyself=window.jid===s.jid,s.commentHavePicture=a.params.commentHavePicture,s.isDissentTag=!(2==s.action||!s.dissentTag);var o=e.user.imgUrl;if(o&&"http://img3.chouti.com/default_avatar_img.png"!==o||(o="/images/image48-9d05fa83eb.png"),s.user.imgUrl=window.CT.replaceHttps(o),a.noOne){s.hasChild=!1;var r=Handlebars.compile(l.DetailTmpl)({comments:[s]});this.$linkItem.find(".comment-con").html(r),a.$commentContainer.show(),a.$noTips.hide(),a.noOne=!1}else{var c=Handlebars.compile(window.CT.ItemTmpl)(_.extend(s,{isFirstLevel:!0}));this.$linkItem.find(".first-parent").prepend(c)}}},{key:"addChildComment",value:function(e,n,t,i,a,s){var o=_.extend(e,{isOperated:n,upClass:t,downClass:i,isSeven:5===s,commentHavePicture:this.params.commentHavePicture});o.isLandlord=this.params.submitJid===o.jid,o.isMyself=window.jid===o.jid,o.isDissentTag=!(2==o.action||!o.dissentTag);var r=e.user.imgUrl;r&&"http://img3.chouti.com/default_avatar_img.png"!==r||(r="/images/image48-9d05fa83eb.png"),o.user.imgUrl=window.CT.replaceHttps(r);var c=$(".comment-li-"+a);if(!!c.hasClass("noChild")){o.hasChild=!1;var l=Handlebars.compile(window.CT.ItemWithUlTmpl)(o);c.removeClass("noChild").append(l)}else{o.hasChild=!0;var m=c.children(".comment-ul"),d=Handlebars.compile(window.CT.ItemTmpl)(o);m.prepend(d)}}},{key:"activeCommentBtn",value:function(){this.$commentBtn.removeClass("disabled")}},{key:"disableCommentBtn",value:function(){this.$commentBtn.addClass("disabled")}},{key:"activeItemCommentBtn",value:function(e){$(".comment-item-area-con-"+e).find(".comment-item-btn").removeClass("disabled")}},{key:"disableItemCommentBtn",value:function(e){$(".comment-item-area-con-"+e).find(".comment-item-btn").addClass("disabled")}},{key:"resetItemCommentArea",value:function(e){var n=this,t=$(".comment-item-area-con-"+e),i=t.find(".preview-item-image"),a=t.find(".comment-item-textarea"),s=t.find(".comment-item-placeholder"),o=t.find(".comment-item-input-num"),r=t.find(".comment-item-btn"),c=t.find(".comment-item-preview-con");t.hide(),i.attr("src",""),a.val(""),c.hide(),o.text(150),n.resetItemErrorTips(e),r.addClass("disabled"),n.url&&n.url.revokeObjectURL(n.comments[""+e].currentImgFile),s.show(),n.comments[""+e]={isLoading:!1,hasImg:!1,textOver:!1,waitImgUrl:"",currentImgFile:""}}},{key:"resetCommentArea",value:function(){var e=this;e.isLoading=!1,e.hasImg=!1,e.$previewCon.hide(),e.$textArea.val("").hide(),e.$previewImage.attr("src",""),e.waitImgUrl="",e.$commentBorder.removeClass("focus"),e.$commentBtn.addClass("disabled"),e.textOver=!1,e.resetErrorTips(),e.url&&e.url.revokeObjectURL(e.currentImgFile),e.$restNum.text(150),e.$topPlaceholder.show()}},{key:"activeCommentArea",value:function(){var e=this;e.resetCommentArea(),e.$commentBorder.addClass("focus"),e.resetErrorTips(),e.$textArea.show().focus(),e.hasImg&&e.$previewCon.show()}},{key:"hideCommentArea",value:function(){this.$commentBorder.removeClass("focus"),this.$textArea.hide(),this.$previewCon.hide(),this.resetCommentArea()}},{key:"hidePreview",value:function(){var e=this;e.$previewCon.hide(),e.hasImg=!1,e.waitImgUrl="",e.url&&e.url.revokeObjectURL(e.currentImgFile)}},{key:"hideItemPreview",value:function(e){var n=$(".comment-item-area-con-"+e);n.find(".preview-item-close"),n.find(".preview-item-image"),n.find(".preview-item-bg-con");n.find(".comment-item-preview-con").hide(),this.comments[""+e]={isLoading:!1,hasImg:!1,textOver:!1,waitImgUrl:"",currentImgFile:""},this.url&&this.url.revokeObjectURL(this.comments[""+e].currentImgFile)}},{key:"showPreviewCon",value:function(){this.$previewClose.hide(),this.$previewImage.hide(),this.$previewBgCon.show(),this.$previewCon.show()}},{key:"showItemPreviewCon",value:function(e){var n=$(".comment-item-area-con-"+e),t=n.find(".preview-item-close"),i=n.find(".preview-item-image"),a=n.find(".preview-item-bg-con"),s=n.find(".comment-item-preview-con");t.hide(),i.hide(),a.show(),s.show()}},{key:"showErrorTips",value:function(e){this.$commentError.text(e).show()}},{key:"resetErrorTips",value:function(){this.$commentError.text("").hide()}},{key:"showItemErrorTips",value:function(e,n){$(".comment-item-area-con-"+n).find(".comment-item-input-error").text(e).show()}},{key:"resetItemErrorTips",value:function(e){$(".comment-item-area-con-"+e).find(".comment-item-input-error").text("").hide()}},{key:"itemProgressing",value:function(e){var n=this,t=$(".comment-item-area-con-"+e).find(".progress-item-percent"),i=0,a=0,s=0,o=0;function r(){clearInterval(s),clearInterval(o),clearInterval(a)}a=setInterval(function(){if(i<=100)if(n.comments[""+e].isLoading)if(i<=80)t.css({width:i+"%"}),i++;else{if(0<s)return!1;s=setInterval(function(){i<=100&&(t.css({width:i+"%"}),i++)},1e3)}else r(),o=setInterval(function(){i<=100?(t.css({width:i+"%"}),i++):(r(),n.killItemProgressing(e))},10);else r(),n.killItemProgressing(e)},10)}},{key:"killItemProgressing",value:function(e){var n=$(".comment-item-area-con-"+e),t=n.find(".preview-item-close"),i=n.find(".preview-item-image"),a=n.find(".preview-item-bg-con");n.find(".comment-item-preview-con");a.hide(),i.show(),t.show()}},{key:"progressing",value:function(){var e=this,n=0,t=0,i=0,a=0;function s(){clearInterval(i),clearInterval(a),clearInterval(t)}t=setInterval(function(){if(n<=100)if(e.isLoading)if(n<=80)e.$percent.css({width:n+"%"}),n++;else{if(0<i)return!1;i=setInterval(function(){n<=100&&(e.$percent.css({width:n+"%"}),n++)},1e3)}else s(),a=setInterval(function(){n<=100?(e.$percent.css({width:n+"%"}),n++):(s(),e.killProgressing())},10);else s(),e.killProgressing()},10)}},{key:"killProgressing",value:function(){this.$previewBgCon.hide(),this.$previewImage.show(),this.$previewClose.show()}}])&&a(e.prototype,n),i&&a(e,i),t}();t.default=i},{"../template/LinkCommentTmpl":3}],7:[function(e,n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=e("../template/LinkTmpl"),l=s(e("./CommentView")),a=s(e("../model/LinkModel"));function s(e){return e&&e.__esModule?e:{default:e}}var o=Backbone.View.extend({el:$(".link-con"),initialize:function(e,n){this.linkModel=e,this.params=n,this.templateNull=Handlebars.compile(i.LinkNullTmpl),this.template=!this.params.subject||"pic"!=this.params.subject&&"video"!=this.params.subject?Handlebars.compile(window.CT.LinkTmpl):Handlebars.compile(i.picItemTmpl),"discovery"==this.params.page&&(this.params.pageNumber=this.linkModel.attributes.pageNumber),"search"==this.params.page&&(this.params.pageNumber=this.linkModel.attributes.page),_.bindAll(this,"render"),this.$linkLoading=$(".loading-more .link-loading-icon"),this.$btn=$(".loading-more .loading-more-btn"),this.$loadingMore=$(".loading-more .loading-more-img-con"),this.$loadingNoMore=$(".loading-more .loading-no-more"),window.commentJc={},this.hoverAfterRender(),this.render(),this.bindEvents()},render:function(){var e=this.linkModel.toJSON();this.renderMore(e)},renderMore:function(e){var n=this;if((!e.links||0==e.links.length)&&0==$(".link-con .link-item").length)return n.noList(),!1;e.isHot="index"==n.params.page,e.notHot="index"!=n.params.page,e.isVideo="zone"==n.params.page&&"video"==n.params.subject,"pic"==n.params.subject?n.appendPicItem(e.links,0):n.$el.append(n.template(e)),n.hoverAfterRender();"zone"==n.params.page&&n.params.subject;e.links&&0===e.links.length?n.noMore():n.showMore()},appendPicItem:function(e,n){this.$el.append(this.template({links:[e[n]],isVideo:!1})),this.waterfallLayout($("#pic_"+e[n].id),n),n<e.length-1&&(n++,this.appendPicItem(e,n))},waterfallLayout:function(e){var n=this,t=$(".waterfall-main"),i=n.params.type,a="hottest"==i?n.linkModel.attributes.columnHottestHeight:n.linkModel.attributes.columnLatestHeight,s=Math.min.apply("",a),o=_.indexOf(a,s),r=s,c=242*o;a[o]+=Number(e.height())+16,"hottest"==i?n.linkModel.set({columnHottestHeight:a}):n.linkModel.set({columnLatestHeight:a}),e.css({position:"absolute",top:"".concat(r,"px"),left:"".concat(c,"px")}),t.css({height:"".concat(Math.max.apply("",a),"px")})},hoverAfterRender:function(){$(".author-avatar").on("error",function(){$(this).attr("src","/images/image48-9d05fa83eb.png")}),$(".matching").on("error",function(){var e=$(this),n=e.parents(".link-item");n.hasClass("pic-item")?n.hasClass("video")?e.attr("src","/images/error_icon2-5e05fe6953.png"):e.attr("src","/images/error_icon3-6c54287d64.png"):e.attr("src","/images/error_icon-a76486aa5a.png"),e.removeClass("image-scale")}),window.CT.generateQrcode()},showLoading:function(){this.$btn.hide(),this.$loadingMore.hide(),this.$loadingNoMore.hide(),this.$linkLoading.show()},showMoreLoading:function(){this.$btn.hide(),this.$linkLoading.hide(),this.$loadingNoMore.hide(),this.$loadingMore.show()},showMore:function(){this.$linkLoading.hide(),this.$loadingNoMore.hide(),this.$loadingMore.hide(),this.$btn.show()},noMore:function(){this.$btn.hide(),this.$linkLoading.hide(),this.$loadingMore.hide(),this.$loadingNoMore.show()},noList:function(){var e=this;e.$btn.hide(),e.$linkLoading.hide(),e.$loadingNoMore.hide(),e.$loadingMore.hide(),"search"==e.params.page?$(".link-con").html(e.templateNull({msg:"这个关键词小抽看不懂，搜点儿别的吧！",showNoSearch:!0})):$(".link-con").html(e.templateNull({msg:"",showNoData:!0}))},bindEvents:function(){var a=this;$(".loading-more-btn").click(function(){a.getLoadingMore()});var t=!0;$(".link-con").off().on("click",".recommend",function(e){var n=$(e.target).parents(".link-item");if(!window.jid)return window.CT.showLogin&&_.isFunction(window.CT.showLogin)?window.CT.showLogin():window.CT.showTopTips("warning","请先登录"),!1;if(1==window.loginedUser.complateReg){return window.CT.showRegisterNext&&_.isFunction(window.CT.showRegisterNext)?window.CT.showRegisterNext({modify:!0}):window.CT.showTopTips("warning","请先完善信息"),!1}if(!t)return!1;t=!1,window.CT.dealRecommendLink(n,function(){t=!0})});var i=!0;$(".link-con").on("click",".save",function(e){var n=$(e.target).parents(".link-item");if(!window.jid)return window.CT.showLogin&&_.isFunction(window.CT.showLogin)?window.CT.showLogin():window.CT.showTopTips("warning","请先登录"),!1;if(1==window.loginedUser.complateReg){return window.CT.showRegisterNext&&_.isFunction(window.CT.showRegisterNext)?window.CT.showRegisterNext({modify:!0}):window.CT.showTopTips("warning","请先完善信息"),!1}if(!i)return!1;i=!1,window.CT.dealSaveLink(n,function(){i=!0})}),$(".link-con").on("click",".link-bore",function(e){var n=$(e.target).parents(".link-item"),t=n.data("id");window.CT.boreLink({linkId:t},function(){n.remove(),0==$(".link-con .link-item").length&&$(".loading-more-btn").click()})}),$(".link-header-item").off().on("click",function(e){var n=$(e.currentTarget),t=n.data("type"),i=n.parents(".link-header");$(e).hasClass("active")||i.hasClass("discovery-header")||($(".link-header-item").removeClass("active"),n.addClass("active"),a.params.type=t,$(".link-con").html(""),a.params.subject&&"pic"==a.params.subject&&$(".pic-con").css({height:0}),a.showLoading(),a.linkModel.set({pageNumber:1,columnHottestHeight:[0,0,0,0,0],columnLatestHeight:[0,0,0,0,0]}),a.linkModel.fetchInit(a.params,function(e){a.renderMore(e)}))}),$(".link-con").on("click",".link-comment",function(e){var n=$(this),t=(n.parents(".link-item"),n.data("noComments")),i=n.data("commentHaveComments"),a=n.data("submitJid"),s=n.data("linkExpire")||!1,o=n.data("id"),r=$(".link-item-"+o),c={linkId:o,noComments:t,commentHavePicture:i,linkExpire:s,sort:1,imgUrl:window.loginedUser.img_url,isNormal:!t&&!s,submitJid:a};window.commentJc.hasOwnProperty(o+"")?window.commentJc[o].init.bind(window.commentJc[o])(r,c):window.commentJc[o]=new l.default(r,c)}),$("html").on("click","body",function(t){_.each(window.commentJc,function(e,n){e.coordinate&&t.pageY>=e.coordinate.min&&t.pageY<=e.coordinate.max&&(e.toggleComment.bind(e)(),_.each(window.commentJc,function(e,n){e._calculateOffset.bind(e)()}))})})},getLoadingMore:function(){var n=this;this.showMoreLoading(),"discovery"!=n.params.page&&"search"!=n.params.page||n.params.pageNumber++,n.linkModel.fetchMore(n.params,function(e){n.renderMore(e)})}});var r=function(n){(0,a.default)(function(e){new o(e,n)},n)};t.default=r},{"../model/LinkModel":2,"../template/LinkTmpl":4,"./CommentView":6}],8:[function(e,n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=e("../template/SearchTmpl"),a=window.CT.config.searchSubjects,s={all:{id:"all",name:"全部"},HOUR24:{id:"HOUR24",name:"24小时内"},DAY3:{id:"DAY3",name:"3天内"},WEEK1:{id:"WEEK1",name:"一周内"},MONTH1:{id:"MONTH1",name:"一月内"},YEAR1:{id:"YEAR1",name:"一年内"}},o={ALL:{id:"ALL",name:"全部"},HOT:{id:"HOT",name:"热榜内容"},PEOPLE:{id:"PEOPLE",name:"人类发布"}},r={words:window.CT.getParam("words")?window.CT.getParam("words"):"",searchType:window.CT.getParam("searchType")?window.CT.getParam("searchType"):2,searchHistory:$.cookie("searchHistory")?JSON.parse($.cookie("searchHistory")):[],subjectId:window.CT.getParam("subjectId")?window.CT.getParam("subjectId"):"",time:window.CT.getParam("time")?window.CT.getParam("time"):"",linkType:window.CT.getParam("linkType")?window.CT.getParam("linkType"):"",subjects:[{id:"ALL",name_cn:"全部"}].concat(Object.keys(a).map(function(e){return a[e]})),publishTime:Object.keys(s).map(function(e){return s[e]}),otherOption:Object.keys(o).map(function(e){return o[e]})},c=Backbone.Model.extend({defaults:{words:r.words,searchNum:0,searchType:r.searchType,selectShow:2==r.searchType,subjects:r.subjects,publishTime:r.publishTime,otherOption:r.otherOption,selectedSubjects:r.subjectId&&a[r.subjectId]?a[r.subjectId]:{id:"ALL",name_cn:"全部"},selectedPublishTime:r.time&&s[r.time]?s[r.time]:r.publishTime[0],selectedOtherOption:r.linkType&&o[r.linkType]?o[r.linkType]:r.otherOption[0],searchHistory:10<r.searchHistory.length?r.searchHistory.slice(-10):r.searchHistory,searchHistoryStr:$.cookie("searchHistory")?$.cookie("searchHistory"):"",showSearchHistory:0<r.searchHistory.length}}),l=Backbone.View.extend({className:"search-header-con",model:new c,template:Handlebars.compile(i.SearchHeaderTmpl),initialize:function(e){this.params=e,this.setSearchHistory("add",e.words),this.$linkLoading=$(".link-loading-icon"),this.$linkLoading.show(),this.$btn=$(".loading-more-btn"),this.listenTo(this.model,"change",this.render),this.render()},setSearchHistory:function(e,n){var t=_.clone(this.model.attributes.searchHistory),i=t.indexOf(n);-1<i&&t.splice(i,1),"add"==e&&""+n&&t.unshift(n);var a=10<t.length?t.slice(0,10):t;$.cookie("searchHistory",JSON.stringify(a)),"delete"==e?(this.model.set({words:n==$(".search-input-text").val()?"":$(".search-input-text").val(),searchNum:$("#search_result_num").html(),searchHistory:a,searchHistoryStr:JSON.stringify(a),showSearchHistory:0<a.length}),0<a.length&&$(".search-history").show()):(this.model.set({searchHistory:a,searchHistoryStr:JSON.stringify(a),showSearchHistory:0<a.length}),$(".search-history").hide())},events:{"click .search-type":"changeSearchType","click .select-li":"changeSelect","keyup .search-input-text":"keyupSearchInput","focus .search-input-text":"focusSearchInput","blur .search-input-text":"blurSearchInput","mouseenter .search-history":"enterSearchHistory","mouseleave .search-history":"leaveSearchHistory","click .search-input-btn":"search","click .search-history-text":"selectHistory","click .search-history-close":"delSearchHistory","click .delete-history":"clearSearchHistory"},render:function(){return this.$el.html(this.template(this.model.attributes)),$(".search-header").html(this.el),this.delegateEvents(),this},changeSearchType:function(e){var n=$(e.currentTarget).data("type");if(!$(e).hasClass("active")){var t=location.search,i="";2==n&&(i=t.replace(/searchType=3/,"searchType=2")),3==n&&(i=t.replace(/searchType=2/,"searchType=3")),location.href="/search"+i}},changeSelect:function(e){var n=$(e.currentTarget),t=n.data("id"),i=n.parents(".select-con").data("name");if(n.hasClass("active"))return!1;var a=[],s="",o=location.search,r=o.split("&"),c="",l=$("#search_result_num").html();"subjects"==i&&(s="subjectId=",a=_.filter(this.model.attributes.subjects,function(e){return e.id==t}),this.model.set({searchNum:l,selectedSubjects:a[0]})),"publishTime"==i&&(s="time=",a=_.filter(this.model.attributes.publishTime,function(e){return e.id==t}),this.model.set({searchNum:l,selectedPublishTime:a[0]})),"otherOption"==i&&(s="linkType=",a=_.filter(this.model.attributes.otherOption,function(e){return e.id==t}),this.model.set({searchNum:l,selectedOtherOption:a[0]})),-1<o.indexOf(s)?_.forEach(r,function(e,n){-1<e.indexOf(s)?"all"!=a[0].id&&"ALL"!=a[0].id&&(c+=(-1<e.indexOf("?")?"":"&")+s+a[0].id):c+=(-1<e.indexOf("?")?"":"&")+e}):"all"!=a[0].id&&"ALL"!=a[0].id&&(c=o+"&"+s+a[0].id),location.href="/search"+c},enterSearchHistory:function(e){$(e.currentTarget).addClass("mouseenter")},leaveSearchHistory:function(e){$(e.currentTarget).removeClass("mouseenter")},keyupSearchInput:function(e){var n=$(e.currentTarget),t=n.parents(".search-input-wrap"),i=t.find(".search-history");t.addClass("focus"),""==n.val()?i.show():i.hide(),"13"==e.keyCode&&this.search()},focusSearchInput:function(e){var n=$(e.currentTarget),t=n.parents(".search-input-wrap"),i=t.find(".search-history");t.addClass("focus"),""==n.val()?i.show():i.hide()},search:function(e){var n=""+$(".search-input-con").find(".search-input-text").val();(n=n.replace(/\s*/g,""))&&(location.href="/search?words="+encodeURIComponent(n)+"&searchType="+this.model.attributes.searchType)},blurSearchInput:function(){var e=$(".search-header-top"),n=e.find(".search-input-wrap"),t=e.find(".search-history");t.hasClass("mouseenter")||(n.removeClass("focus"),t.hide())},selectHistory:function(e){var n=$(e.currentTarget).html();$(".search-input-text").val(n).focus(),$(".search-history").hide()},delSearchHistory:function(e){var n=$(e.currentTarget).parents(".search-history-item").find(".search-history-text").html();this.setSearchHistory("delete",n)},clearSearchHistory:function(){$.removeCookie("searchHistory"),this.model.set({words:$(".search-input-text").val(),searchNum:$("#search_result_num").html(),searchHistory:[],showSearchHistory:!1}),$(".search-history-text").focus()}});var m=function(e){new l(e)};t.default=m},{"../template/SearchTmpl":5}],9:[function(e,n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,a=(i=e("../model/LinkModel"))&&i.__esModule?i:{default:i},s=e("../template/SearchTmpl"),o=e("../template/LinkTmpl");var r=Backbone.View.extend({el:$(".link-con"),template:Handlebars.compile(s.SearchUserListTmpl),initialize:function(e,n){this.linkModel=e,this.params=n,this.templateNull=Handlebars.compile(o.LinkNullTmpl),_.bindAll(this,"render"),this.$linkLoading=$(".link-loading-icon"),this.$linkLoading.hide(),this.$btn=$(".loading-more-btn"),this.$loading=$(".loading-more-img-con"),this.$loadingNoMore=$(".loading-no-more"),this.$btn.show(),this.render(),this.bindEvents()},events:{"click .attention-btn":"dealAttention"},render:function(){var e=this.linkModel.toJSON();return this.renderMore(e),this.delegateEvents(),this},renderMore:function(e){var n=this;n.changeBtnStatus(),e.userList&&e.userList.length<25&&n.noMore(),(!e.userList||0==e.userList.length&&0==$(".link-con .user-items").length)&&n.noList(),n.$el.append(n.template(e)),n.hoverAfterRender()},hoverAfterRender:function(){$(".author-avatar").on("error",function(){var e=$(this);e.attr("src","/images/image48-9d05fa83eb.png"),e.off("error")}),$(".user-pic").on("error",function(){var e=$(this);e.attr("src","/images/image48-9d05fa83eb.png"),e.off("error")}),window.CT.generateQrcode()},changeBtnStatus:function(e){e?(this.$btn.hide(),this.$loading.css({display:"inline-block"})):(this.$loading.hide(),this.$btn.css({display:"inline-block"}))},noMore:function(){this.$btn.hide(),this.$loadingNoMore.show()},noList:function(){var e=this;e.$btn.hide(),e.$linkLoading.hide(),e.$loadingNoMore.hide(),"search"==e.params.page?$(".link-con").html(e.templateNull({msg:"这个关键词小抽看不懂，搜点儿别的吧！",showNoSearch:!0})):$(".link-con").html(e.templateNull({msg:"",showNoData:!0}))},bindEvents:function(){var e=this;$(".loading-more-btn").off().click(function(){e.loadingMore()})},loadingMore:function(){var n=this;this.changeBtnStatus(!0),n.params.pageNumber++,n.linkModel.fetchMore(n.params,function(e){n.renderMore(e)})},dealAttention:function(e){var n=$(e.currentTarget),t=n.data("jid");n.hasClass("unattention")&&window.CT.doAttention({jid:window.jid,toJid:t},function(e){window.CT.showTopTips("success",e.info),n.removeClass("unattention").addClass("attention")}),(n.hasClass("attention")||n.hasClass("each"))&&window.CT.cancelAttention({jid:window.jid,toJid:t},function(e){window.CT.showTopTips("success",e.info),n.removeClass("attention each").addClass("unattention")})}});var c=function(n){(0,a.default)(function(e){new r(e,n)},n)};t.default=c},{"../model/LinkModel":2,"../template/LinkTmpl":4,"../template/SearchTmpl":5}]},{},[1]);